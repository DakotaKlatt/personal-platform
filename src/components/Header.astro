---
const currentPath = Astro.url.pathname;
const nav = [
  { label: 'Projects', href: '/projects' },
  { label: 'Blog', href: '/blog' },
  { label: 'About', href: '/about' },
  { label: 'Personal', href: '/personal' },
  { label: 'Contact', href: '/contact' },
];
---

<header class="sticky top-0 z-50 border-b border-[var(--color-border)] bg-[var(--color-bg)]/80 backdrop-blur-md">
  <div class="mx-auto flex h-16 max-w-5xl items-center justify-between px-6">
    <a href="/" class="font-display font-semibold text-[var(--color-text)] hover:text-accent transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-accent focus-visible:outline-offset-2 rounded">
      Dakota Klatt
    </a>
    <nav class="flex items-center gap-1" aria-label="Main navigation">
      {nav.map((item) => {
        const isActive = currentPath === item.href || (item.href !== '/' && currentPath.startsWith(item.href));
        return (
          <a
            href={item.href}
            class:list={[
              'rounded-md px-3 py-2 text-sm font-medium transition-colors',
              isActive
                ? 'text-accent bg-accent/10'
                : 'text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-elevated)]',
            ]}
          >
            {item.label}
          </a>
        );
      })}
      <button
        type="button"
        id="theme-toggle"
        class="theme-toggle rounded-md p-2 text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-elevated)] transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-accent focus-visible:outline-offset-2"
        aria-label="Toggle dark mode"
        title="Toggle dark mode"
      >
        <span class="theme-icon-light inline" aria-hidden="true">üåô</span>
        <span class="theme-icon-dark hidden" aria-hidden="true">‚òÄÔ∏è</span>
      </button>
    </nav>
  </div>
</header>

<style>
  .theme-toggle .theme-icon-light { display: inline; }
  .theme-toggle .theme-icon-dark { display: none; }
  html.dark .theme-toggle .theme-icon-light { display: none; }
  html.dark .theme-toggle .theme-icon-dark { display: inline; }
</style>
<script>
  (function () {
    var storageKey = 'theme';
    var darkClass = 'dark';

    document.getElementById('theme-toggle')?.addEventListener('click', function () {
      var root = document.documentElement;
      var isDark = root.classList.contains(darkClass);
      if (isDark) {
        root.classList.remove(darkClass);
        localStorage.setItem(storageKey, 'light');
      } else {
        root.classList.add(darkClass);
        localStorage.setItem(storageKey, 'dark');
      }
    });
  })();
</script>
